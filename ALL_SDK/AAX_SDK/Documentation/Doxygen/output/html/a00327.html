<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>AAX SDK: Real-time algorithm callback</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="aaxdoxy.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cw_105x65_aax_buf.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AAX SDK
   &#160;<span id="projectnumber">2.3.1</span>
   </div>
   <div id="projectbrief">Avid Audio Extensions Development Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="modules.html"><span>Manual</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="pages.html"><span>Lists</span></a></li>
      <li><a href="usergroup0.html"><span>Support</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Real-time algorithm callback<div class="ingroups"><a class="el" href="a00323.html">AAX SDK Manual</a> &raquo; <a class="el" href="a00325.html">Core AAX Interface</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>A plug-in's audio processing core. </p>
<h1><a class="anchor" id="algpagecontents"></a>
On this page</h1>
<ul>
<li><a class="el" href="a00327.html#alg_def">Algorithm definition</a> </li>
<li><a class="el" href="a00327.html#alg_memmgmt">Algorithm memory management</a> </li>
<li><a class="el" href="a00327.html#alg_comm">Communicating with the algorithm</a> </li>
<li><a class="el" href="a00327.html#alg_initialization">Algorithm initialization</a> </li>
<li><a class="el" href="a00327.html#alg_processing">Algorithm processing</a> </li>
<li><a class="el" href="a00327.html#alg_pd">Persistent algorithm memory</a> </li>
<li><a class="el" href="a00327.html#alg_examp">Example algorithm callback</a> </li>
<li><a class="el" href="a00327.html#alg_porttypes">Port Types and Behavior</a> </li>
<li><a class="el" href="a00327.html#alg_seealso">Additional Information</a></li>
</ul>
<div class="section"> </div><h1><a class="anchor" id="alg_def"></a>
Algorithm definition</h1>
<div class="section"> Algorithm processing in AAX plug-ins is handled via a C-style algorithm processing callback (see code below.) Each Effect variation in a plug-in must register an algorithm entrypoint in the plug-in <a class="el" href="a00326.html">description</a>, and the host will call this entrypoint to render a buffer of audio samples.</div><div class="section"><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="a00149.html#aaa22112139aa627574b1ef562f579d43">AAX_CALLBACK</a> MyPlugIn_AlgorithmProcessFunction(</div>
<div class="line">    SMyPlugIn_Alg_Context * <span class="keyword">const</span>   inInstancesBegin [],</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">void</span> *                    inInstancesEnd)</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">        <span class="comment">// Processing code...</span></div>
<div class="line">        <span class="comment">//</span></div>
<div class="line">    }</div>
</div><!-- fragment --> </div><div class="section"> </div><h1><a class="anchor" id="alg_memmgmt"></a>
Algorithm memory management</h1>
<div class="section"> This callback pattern is designed such that plug-in algorithms may be easily loaded in remote memory spaces on a variety of devices and quickly re-compiled for different operating environments without significant changes to the code, and this design goal informs the algorithm's memory management techniques.</div><div class="section"> <div class="dotgraph">
<img class="centered" src="dot_aax_alg_context.png" alt="dot_aax_alg_context.png" border="0" usemap="#dot_aax_alg_context.map"/>
<map name="dot_aax_alg_context.map" id="dot_aax_alg_context.map"><area shape="poly" id="node1" href="a00327.html" title="Algorithm callback" alt="" coords="101,111,130,109,154,105,169,99,175,92,172,85,162,77,146,71,128,66,108,63,88,63,68,64,49,68,32,74,19,81,12,89,13,96,24,102,44,107,71,110"/><area shape="rect" id="node2" title="Custom context structure" alt="" coords="5,135,181,340"/><area shape="rect" id="node3" title="Custom context structure" alt="" coords="257,5,329,61"/><area shape="rect" id="node4" title="Custom context structure" alt="" coords="257,85,329,141"/><area shape="rect" id="node5" title="Custom context structure" alt="" coords="257,165,329,213"/><area shape="rect" id="node6" title="Custom context structure" alt="" coords="233,237,354,341"/><area shape="rect" id="node7" title="Custom context structure" alt="" coords="233,365,354,469"/><area shape="rect" id="node8" title="Custom context structure" alt="" coords="229,493,357,597"/><area shape="rect" id="node9" title="Custom context structure" alt="" coords="229,621,357,725"/></map>
</div>
</div><div class="section"> When the AAX host calls a plug-in's algorithm callback, it provides a block of memory describing the state of the plug-in. This block of memory, known as the algorithm's <em>context</em>, can be thought of as the algorithm's interface to the outside world: when another part of the plug-in interacts with the algorithm, it does so by posting information to the algorithm's context.</div><div class="section"><div class="fragment"><div class="line"><span class="comment">//==============================================================================</span></div>
<div class="line"><span class="comment">// Component context definitions</span></div>
<div class="line"><span class="comment">//==============================================================================</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Context structure</span></div>
<div class="line"><span class="keyword">struct </span>SDemoDist_Alg_Context</div>
<div class="line">{</div>
<div class="line">    int32_t                 * mCtrlBypassP;                 <span class="comment">// Coefficient message destination</span></div>
<div class="line">    <span class="keywordtype">float</span>                   * mCtrlMixP;                    <span class="comment">// Coefficient message destination</span></div>
<div class="line">    <span class="keywordtype">float</span>                   * mCtrlInpGP;                   <span class="comment">// Coefficient message destination</span></div>
<div class="line">    <span class="keywordtype">float</span>                   * mCtrlOutGP;                   <span class="comment">// Coefficient message destination</span></div>
<div class="line">    SDemoDist_DistCoefs     * mCoefsDistP;                  <span class="comment">// Coefficient message destination</span></div>
<div class="line">    SDemoDist_FiltCoefs     * mCoefsFiltP;                  <span class="comment">// Coefficient message destination</span></div>
<div class="line"></div>
<div class="line">    CSimpleBiquad           * mBiquads;                     <span class="comment">// Private data</span></div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">float</span>*                  * mInputPP;                     <span class="comment">// Audio signal input</span></div>
<div class="line">    <span class="keywordtype">float</span>*                  * mOutputPP;                    <span class="comment">// Audio signal output</span></div>
<div class="line">    <span class="keywordtype">float</span>*                  * mMeterTapsPP;                 <span class="comment">// Meter signal output</span></div>
<div class="line">};</div>
</div><!-- fragment --></div><div class="section"> It is important to note that, in most circumstances, algorithm callbacks do not own their own memory. The algorithm and its memory is managed entirely by the host or shell environment, and relies on the host-provided context structure for all state information.</div><div class="section"> If persistent memory is required, algorithms can register for block(s) of persistent state date via the <a class="el" href="a00088.html#a125949841a13e97ff93fa321f2050433">AAX_IComponentDescriptor::AddPrivateData()</a> API (as in SDemoDist_Alg_Context::mBiquads above.) A plug-in may store state data in the resulting <em>"private data"</em> context fields and this data will be restored by the host when the algorithm is next called. See the <a class="el" href="a00327.html#alg_pd">Persistent algorithm memory</a> section below for more information. </div><div class="section"> </div><h1><a class="anchor" id="alg_comm"></a>
Communicating with the algorithm</h1>
<div class="section"> Plug-ins communicate with their algorithms via a buffered, host-managed message system. The host guarantees that messages posted to this system will be delivered to the applicable context field and that the algorithm's context is up to date every time the component is entered.</div><div class="section"> This system utilizes a static data routing scheme that is defined in the plug-in's describe method. Once the routing scheme has been defined, the plug-in may post packets of data to its algorithm using <a class="el" href="a00090.html#ae5dd2b5925dbc181513bca1c4ac5e716">AAX_IController::PostPacket()</a>.</div><div class="section"> In order to reference the fields in its algorithm's context, the plug-in's host-side code uses unique identifiers generated with the <a class="el" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> macro:</div><div class="section"><div class="fragment"><div class="line"><span class="keyword">enum</span> EDemoDist_Alg_PortID</div>
<div class="line">{</div>
<div class="line">     eAlgPortID_BypassIn                    = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mCtrlBypassP)</div>
<div class="line">    ,eAlgPortID_MixIn                       = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mCtrlMixP)</div>
<div class="line">    ,eAlgPortID_InpGIn                      = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mCtrlInpGP)</div>
<div class="line">    ,eAlgPortID_OutGIn                      = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mCtrlOutGP)</div>
<div class="line">    ,eAlgPortID_CoefsDistIn                 = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mCoefsDistP)</div>
<div class="line">    ,eAlgPortID_CoefsFilterIn               = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mCoefsFiltP)</div>
<div class="line"></div>
<div class="line">    ,eAlgFieldID_Biquads                    = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mBiquads)</div>
<div class="line"></div>
<div class="line">    ,eDemoDist_AlgFieldID_AudioIn           = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mInputPP)</div>
<div class="line">    ,eDemoDist_AlgFieldID_AudioOut          = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mOutputPP)</div>
<div class="line">    ,eAlgFieldID_MeterTaps                  = <a class="code" href="a00149.html#acf807247ecd6e5899dc9dc31644e9a1d">AAX_FIELD_INDEX</a> (SDemoDist_Alg_Context, mMeterTapsPP)</div>
<div class="line">};</div>
</div><!-- fragment --></div><div class="section"> See <a class="el" href="a00326.html">Description callback</a> for more information about registering context fields and defining a plug-in's message routing scheme. </div><div class="section"> </div><h1><a class="anchor" id="alg_initialization"></a>
Algorithm initialization</h1>
<div class="section"> The following events occur before the AAX host begins calling a plug-in's algorithm:</div><div class="section"> <ul>
<li>The Effect's <a class="el" href="a00328.html">data model</a> is initialized </li>
<li>An initial call to <a class="el" href="a00061.html#a6e87e40d42c7431e52ae5ebd4f631964">AAX_IEffectParameters::ResetFieldData()</a> is made for each private data block in the algorithm. </li>
<li>An initial call to <a class="el" href="a00061.html#a083265b008921b6114ede387711694b7">AAX_IEffectParameters::GenerateCoefficients()</a> is made and coefficient packets are dispatched to each of the algorithm's data ports based on the default model state. </li>
<li>All packets are delivered and initial algorithm context state is set </li>
<li>If one has been registered, the algorithm's optional initialization callback is called with the default context </li>
<li>(Algorithmic processing begins)</li>
</ul>
</div><h2><a class="anchor" id="alg_initialization_private_data"></a>
Private data initialization</h2>
<div class="section"> To initialize an algorithm's private data blocks, <a class="el" href="a00061.html#a6e87e40d42c7431e52ae5ebd4f631964">AAX_IEffectParameters::ResetFieldData()</a> is called on the host for each block in the algorithm. The host uses this method to acquire a default initialized memory block for each private data port, which is then copied into the algorithm's memory pool and provided to its context.</div><div class="section"> The default implementation of this method in <a class="el" href="a00018.html#accef965824c9b158cafb65e59e216b6a">AAX_CEffectParameters</a> will initialize the data to zero.</div><div class="section"> <dl class="section see"><dt>See also</dt><dd><a class="el" href="a00327.html#alg_pd">Persistent algorithm memory</a></dd></dl>
</div><h2><a class="anchor" id="alg_initialization_optional_callback"></a>
Optional initialization callback</h2>
<div class="section"> If any additional initialization or de-initialization steps are required for proper operation of the algorithm, an optional initialization routine may be registered and associated with the algorithm's processing callback. This initialization routine will be called in the same device / memory space as the algorithm's processing context. The initialization callback is provided with the algorithm's default context and is called both before every new instance of the Effect begins its algorithm render callbacks and before every instance is destroyed.</div><div class="section"> This initialization routine is provided in <a class="el" href="a00326.html">Describe</a> as an argument to the platform's <code>AddProcessProc</code> registration method:</div><div class="section"> <ul>
<li><a class="el" href="a00088.html#a1c069508cf54a523905c8160ebf628ad">AAX_IComponentDescriptor::AddProcessProc_Native()</a> </li>
<li><a class="el" href="a00088.html#aa8443e720e48046444a2e9f712f0864b">AAX_IComponentDescriptor::AddProcessProc_TI()</a></li>
</ul>
<dl class="compatibility_notes"><dt><b><a class="el" href="a00380.html#_compatibility_notes000002">Host Compatibility Notes:</a></b></dt><dd>As of Pro Tools 10.2.1 an algorithm's initialization calllback routine will have up to 5 seconds to execute.</dd></dl>
</div><div class="section"> <dl class="section see"><dt>See also</dt><dd><a class="el" href="a00163.html#a3963a850079d3186e08c97a1a4d0ef1c">AAX_CInstanceInitProc</a></dd></dl>
</div><div class="section"> </div><h1><a class="anchor" id="alg_processing"></a>
Algorithm processing</h1>
<div class="section"> Once the algorithm has been initialized and processing begins, the algorithm function is called regularly by the host audio engine. The algorithm may read the context data provided by the host and is responsible for writing data to all of the samples in its output buffers each time it is executed.</div><div class="section"> <dl class="section note"><dt>Note</dt><dd>The data in an algorithm's output buffers is not initialized before the algorithm is called, thus the algorithm must always write data into all output samples. This is to ensure equivalent behavior between all platforms, some of which do not have the resource budget to pre-initialize output data buffers.</dd></dl>
</div><div class="section"> </div><h1><a class="anchor" id="alg_pd"></a>
Persistent algorithm memory</h1>
<div class="section"> An AAX plug-in algorithm may contain one or more <em>private data</em> ports in its context. These are the only context fields in which an algorithm may store persistant state data.</div><div class="section"></div><h2><a class="anchor" id="alg_pd_characteristics"></a>
Private memory characteristics</h2>
<div class="section"> Each private data port is a pointer to a preallocated block of memory. The size of each port is defined during Describe when the port is registered. On DSP systems, the plug-in may request that the data block be placed in the chip's external memory.</div><div class="section"> Once private data is allocated by the plug-in host or DSP shell, it will not be relocated or re-allocated until the algorithm is destroyed (see <a class="el" href="a00327.html#alg_initialization_optional_callback">Optional initialization callback</a>)</div><div class="section"></div><h2><a class="anchor" id="alg_pd_registration"></a>
Private data port registration</h2>
<div class="section"> Private data ports are registered during Describe via <a class="el" href="a00088.html#a125949841a13e97ff93fa321f2050433">AAX_IComponentDescriptor::AddPrivateData()</a>. This method defines the size of the data block that will be allocated as well as an initialization callback with format <a class="el" href="a00163.html#adfb5d89b9d957c541fc98fe42bc050c4">AAX_CInitPrivateDataProc</a>.</div><div class="section"></div><h2><a class="anchor" id="alg_pd_init"></a>
Private data initialization</h2>
<div class="section"> <a class="el" href="a00061.html#a6e87e40d42c7431e52ae5ebd4f631964">AAX_IEffectParameters::ResetFieldData()</a> is called on the host for both Native and DSP plug-ins. For DSP plug-ins, the initialized data block is copied to the DSP by the AAX host following the initialization callback. The initialization callbacks for a plug-in's private data blocks are called after all host modules have been initialized and before the algorithm's optional initialization callback.</div><div class="section"> <dl class="section see"><dt>See also</dt><dd><a class="el" href="a00327.html#alg_initialization">Algorithm initialization</a></dd></dl>
</div><h2><a class="anchor" id="alg_pd_comm"></a>
Private data communication</h2>
<div class="section"> It is possible to transfer data to and from the algorithm's private data blocks using the <a class="el" href="a00111.html">AAX_IPrivateDataAccess</a> interface, which is available in a TimerWakeup context through the <a class="el" href="a00097.html">AAX_IEffectDirectData</a> interface. For more information about this API, see auxinterface_directdata_privatedataaccess.</div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="alg_examp"></a>
Example algorithm callback</h1>
<div class="section"> As a final example, the code below describes a simple audio processing component. The component's context contains one message pointer to receive incoming "gain" parameter values, as well as one audio data input, "pdI", and one audio data output, "pdO". Additionally there is a message pointer to receive "bypass" on/off values. The host calls the component each time a new input sample buffer must be processed, and each time the component is called the host ensures that all context fields are up-to-date.</div><div class="section"><div class="fragment"><div class="line"><span class="keywordtype">void</span> <a class="code" href="a00149.html#aaa22112139aa627574b1ef562f579d43">AAX_CALLBACK</a> MyPlugIn_AlgorithmProcessFunction(</div>
<div class="line">    SMyPlugIn_Alg_Context * <span class="keyword">const</span>   inInstancesBegin [],</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">void</span> *                    inInstancesEnd)</div>
<div class="line">    {</div>
<div class="line"></div>
<div class="line">        <span class="comment">// Get a pointer to the beginning of the memory block table</span></div>
<div class="line">        SMyPlugIn_Alg_Context* AAX_RESTRICT instance = inInstancesBegin [0];</div>
<div class="line"></div>
<div class="line">        <span class="comment">//--------- Iterate over plug-in instances ---------//</span></div>
<div class="line">        <span class="keywordflow">for</span> (SMyPlugIn_Alg_Context * <span class="keyword">const</span> * walk = inInstancesBegin; walk &lt; inInstancesEnd; ++walk)</div>
<div class="line">        {</div>
<div class="line">            instance = *walk;</div>
<div class="line"></div>
<div class="line">            <span class="comment">//--------- Retrieve instance-specific information ---------//</span></div>
<div class="line">            <span class="comment">//</span></div>
<div class="line">            <span class="keyword">const</span> SMyPlugIn_CoefsGain* <span class="keyword">const</span> AAX_RESTRICT   coefsGainP =    instance-&gt;mCoefsGainP;  <span class="comment">// Input (const)</span></div>
<div class="line">            <span class="keyword">const</span> int32_t   bypass      = *instance-&gt;mCtrlBypassP; </div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">float</span>     gain        = coefsGainP-&gt;mGain;</div>
<div class="line"></div>
<div class="line">            <span class="comment">//--------- Run processing loop over each input channel ---------//</span></div>
<div class="line">            <span class="comment">//</span></div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch = 0; ch &lt; kNumChannelsIn; ch++) <span class="comment">// Iterate over all input channels</span></div>
<div class="line">            {</div>
<div class="line"></div>
<div class="line">                <span class="comment">//--------- Run processing loop over each sample ---------//</span></div>
<div class="line">                <span class="comment">//</span></div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> t = 0; t &lt; kAudioWindowSize; t++)</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">float</span>* <span class="keyword">const</span> AAX_RESTRICT pdI = instance-&gt;mInputPP [ch];</div>
<div class="line">                    <span class="keywordtype">float</span>* <span class="keyword">const</span> AAX_RESTRICT pdO = instance-&gt;mOutputPP [ch];</div>
<div class="line"></div>
<div class="line">                    <span class="keywordflow">if</span> ( pdI &amp;&amp; pdO )</div>
<div class="line">                    {</div>
<div class="line">                        pdO [t] = gain * pdI [t];</div>
<div class="line">                        <span class="keywordflow">if</span> (bypass) { pdO [t] = pdI [t]; } </div>
<div class="line">                    }</div>
<div class="line">                } <span class="comment">// Go to the next sample</span></div>
<div class="line">            } <span class="comment">// Go to next channel</span></div>
<div class="line">        } <span class="comment">// End instance-iteration loop</span></div>
<div class="line">    }</div>
</div><!-- fragment --></div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="alg_porttypes"></a>
Port Types and Behavior</h1>
<div class="section">In this section, we will examine the various kinds of ports that can be used by the algorithm component in an AAX plug-in: </p><ol>
<li class="List">
Standard message input  </li>
<li class="List">
Internal state storage  </li>
<li class="List">
Metering output  </li>
<li class="List">
Environment variable retrieval  </li>
<li class="List">
Other functionality enhancement  </li>
</ol>
</div><div class="section"></div><h2><a class="anchor" id="subsection__standard_message_input"></a>
Standard message input</h2>
<div class="section">Most ports will function as pointers to incoming data. This data can have any type. For example, an algorithm's context may include a port of type float* to receive incoming float data and another port of type <code>SMyCustomStructure</code>* to receive incoming <code>SMyCustomStructure</code> data.</div><div class="section">Like all registered context fields, input ports are managed by the hosting environment such that they always point to the most recently received data at the time that the algorithm callback is entered. The algorithm may not store or alter data in a standard message input port: this data is available as read-only input. If data is stored in the space allocated for the port's data then the result will be undefined behavior.</div><div class="section">To define a standard message input port, a plug-in should call <a class="el" href="a00088.html#a230293b9f6bb413626cd487ca501df75">AAX_IComponentDescriptor::AddDataInPort()</a>.</div><div class="section"></div><h2><a class="anchor" id="subsection__internal_state_storage"></a>
Internal state storage</h2>
<div class="section">Most plug-ins require local data to be accessible to their algorithms. These may be static data, such as lookup tables, or dynamic data, such as coefficient smoothing history or delay lines. In the DemoDist sample plug-in, <code>SDemoDist_Alg_Context::mBiquads</code> is an example of this type of port: it is not modified by any other component and <code>DemoDist_AlgorithmProcessFunction()</code> relies on the <code>mBiquads</code> data persisting between processing calls.</div><div class="section">A component that has registered a private data field is given access to a block of private data. Although the memory in this block will be allocated by the host, its data is fully owned by the component. Because this data is considered private to its parent component, other components cannot overwrite or target this data. Plug-ins that need to transmit data directly between their algorithms' private data ports and their other modules may use the <a class="el" href="a00097.html">AAX_IEffectDirectData</a> interface, which provides an API for reading from or writing to this data from outside of the algorithm callback.</div><div class="section">The plug-in's data model includes an initialization function that is called by the AAX host at the time of plug-in instantiation and "reset" events. This initialization method is called on the host for both Native and DSP plug-ins. Since this method is part of the plug-in's data model, it has direct access to plug-in state information.</div><div class="section"></div><h2><a class="anchor" id="subsection__metering_output"></a>
Metering output</h2>
<div class="section">Plug-in metering ports are populated with an array of float values, or 'taps'. One tap is provided per plug-in meter. The algorithm writes per-buffer peak values to this port and the AAX host applies standardized ballistics to these values. Both raw and processed meter values are available to the plug-in's GUI.</div><div class="section"></div><h2><a class="anchor" id="subsection__environment_variable_retrieval"></a>
Environment variable retrieval</h2>
<div class="section">Another use of ports is to receive data from the AAX host describing the execution environment. For example, an algorithm may include a port to receive the number of samples in its processing window or the sample rate. These services are provided automatically by the host once the component registers ports for them.</div><div class="section"></div><h2><a class="anchor" id="subsection__other_functionality_enhancement"></a>
Other functionality enhancement</h2>
<div class="section">An algorithm component may use ports to gain additional functionality that is provided by the host. For example, an algorithm that will be compiled for accelerated environments may take advantage of the TI chip's Direct Memory Access functionality by registering a DMA port. The host will then allow this port to access memory directly using <a class="el" href="a00288.html">AAX</a>'s DMA APIs.</div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="alg_seealso"></a>
Additional Information</h1>
<div class="section"> For information about optional features for the algorithm processing callback, see the following <a class="el" href="a00332.html">Additional AAX features</a> documentation:</div><div class="section"> <ul>
<li><a class="el" href="a00340.html">Direct Memory Access</a> </li>
<li><a class="el" href="a00341.html">Background processing callback</a></li>
</ul>
</div> <div class="dynheader">
Collaboration diagram for Real-time algorithm callback:</div>
<div class="dyncontent">
<center><table><tr><td><img src="a00327.png" border="0" alt="" usemap="#a00327"/>
<map name="a00327" id="a00327">
<area shape="rect" id="node2" href="a00325.html" title="Main classes, callbacks, and format specification details for a standard AAX plug&#45;in. " alt="" coords="5,13,143,39"/></map>
</td></tr></table></center>
</div>
</div><!-- contents -->
<!--        Copyright 2016, 2018 by Avid Technology, Inc.        -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<div class="FooterLegal">This product may be protected by one or more U.S. and non-U.S. patents. Details are available at <a href="https://www.avid.com/patents">www.avid.com/patents</a>.</div>
Generated on Fri Feb 2 2018 21:14:22 for AAX SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>

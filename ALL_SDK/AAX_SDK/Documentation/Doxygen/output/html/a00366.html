<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>AAX SDK: DTT Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="aaxdoxy.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cw_105x65_aax_buf.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AAX SDK
   &#160;<span id="projectnumber">2.3.1</span>
   </div>
   <div id="projectbrief">Avid Audio Extensions Development Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="modules.html"><span>Manual</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="pages.html"><span>Lists</span></a></li>
      <li><a href="usergroup0.html"><span>Support</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DTT Guide<div class="ingroups"><a class="el" href="a00323.html">AAX SDK Manual</a> &raquo; <a class="el" href="a00359.html">AAX Host Guides</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>How to automate different test scenarios for DSH. </p>
<h1><a class="anchor" id="dtt_guide_contents"></a>
Contents</h1>
<ul>
<li><a class="el" href="a00366.html#dtt_guide_00_what_is_dtt">What is DTT</a> </li>
<li><a class="el" href="a00366.html#dtt_guide_01_how_to_run_test_and_suites_in_dtt">How to run tests and suites in DTT</a> </li>
<li><a class="el" href="a00366.html#dtt_guide_03_writing_dtt_scripts">Writing DTT scripts</a> </li>
<li><a class="el" href="a00366.html#dtt_guide_04_logging_in_dtt_and_debuggin_dtt_scripts">Logging in DTT and debugging DTT scripts</a> </li>
<li><a class="el" href="a00366.html#dtt_guide_02_working_with_dtt_test_suites">Working with DTT test suites</a></li>
</ul>
<div class="section"> </div><h1><a class="anchor" id="dtt_guide_00_what_is_dtt"></a>
What is DTT</h1>
<div class="section"> DishTestTool (DTT) is a Ruby-based command line tool, which provides the ability to script and thus automate DSH test scenarios. It is included in the DigiShell Tools package in the /DTT directory.</div><div class="section"><dl class="section note"><dt>Note</dt><dd>Ruby is installed by default on OS X. On Windows, you will need to install Ruby and add it to your PATH variable manually. For information regarding Ruby version compatibility with a specific build of DTT, see the ReadMe.txt file in /DTT/sources.</dd></dl>
<p>The DTT folder consists of: </p><ul>
<li class="Bullet">
<em>Sources</em> <ul>
<li class="Bullet">
DTT core </li>
<li class="Bullet">
<p class="startli"><em>scripts</em> folder - place all DTT script files here</p>
<p>By default, this folder includes a few example scripts demonstrating basic DTT operations and plug-in testing steps:</p>
<ul>
<li class="Bullet">
<em>DSH_SigCancellation.rb</em> - script for the cancellation test  </li>
<li class="Bullet">
<em>DSH_TI_CycleCounts</em> - script for performing cycle count test </li>
<li class="Bullet">
<em>SuiteGenerator.rb</em> - generates suites for the DSH_SigCancellation and DSH_TI_CycleCounts tests </li>
</ul>
</li>
<li class="Bullet">
<em>suites</em> folder - place your DTT suite files here </li>
</ul>
</li>
<li class="Bullet">
<em>run_test.command</em> (on Mac) or <em>run_test.bat</em> (on Windows) - command file for runnung tests </li>
<li class="Bullet">
<em>run_irb.command</em> (on Mac) or <em>run_irb.bat</em> (on Windows) - command-line interpreter </li>
</ul>
</div><div class="section"> </div><h1><a class="anchor" id="dtt_guide_01_how_to_run_test_and_suites_in_dtt"></a>
How to run tests and suites in DTT</h1>
<div class="section"> <code>run_test</code> is the main DTT execution program. <code>run_test</code> is able to execute Ruby scripts which have been placed in the scripts folder within the DTT directory.</div><div class="section"><ul>
<li class="Bullet">
<code>run_test.command -l</code> - lists all the available scripts and suites </li>
<li class="Bullet">
<code>run_test.command 1</code> - runs test by number </li>
<li class="Bullet">
<code>run_test.command DSH_SigCancellation</code> - runs a test by name. Pay attensions that the name of test should be without (!) extension. </li>
<li class="Bullet">
<code>run_test.command &ndash;script DSH_SigCancellation -a sample_rate=48000 -a threshold=-80</code> - runs a test with test script arguments, which are specified using the <code>-a</code> option </li>
</ul>
</div><div class="section"><div class="image">
<img src="DTT_run_tests.png"  width="70%" alt="Running DTT tests"/>
</div>
 <div class="imagecaption">Figure 1: running DTT tests.</div></div><div class="section">For more information about script arguments, see <a class="el" href="a00366.html#describing_and_using_input_arguments_of_the_script">Describing and using input arguments of the script</a></div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="dtt_guide_03_writing_dtt_scripts"></a>
Writing DTT scripts</h1>
<div class="section"> Most of the DTT scripts require <code>DigiShell</code>, which allows them to run dsh and execute different dsh commands. Each script should be represented in the form of class, which inherits Script class, and also each script must have at least two elements: self.inputs section, where all the input arguments of the test should be described, and run method, which is the main body of your script.</div><div class="section"><div class="fragment"><div class="line">require <span class="stringliteral">&#39;DigiShell&#39;</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">class </span>ScriptSample &lt; Script</div>
<div class="line">   def self.inputs</div>
<div class="line">      return {}</div>
<div class="line">   end</div>
<div class="line"></div>
<div class="line">   def run</div>
<div class="line">      <span class="keywordflow">return</span> pass(<span class="stringliteral">&quot;Well, it didn&#39;t explode.  So that&#39;s something.&quot;</span>);</div>
<div class="line">   end</div>
<div class="line">end</div>
</div><!-- fragment --> <div class="fragmentcaption">Listing 1: Skeleton of the script</div></div><div class="section"></div><h2><a class="anchor" id="describing_and_using_input_arguments_of_the_script"></a>
Describing and using input arguments of the script</h2>
<div class="section"> The available parameters and their values for a script are listed in the static <code>self.inputs</code> routine. Input arguments must be organized in the form of a hash map which is returned from this routine.</div><div class="section"><div class="fragment"><div class="line">def <span class="keyword">self</span>.inputs</div>
<div class="line">    <span class="keywordflow">return</span> {</div>
<div class="line">      :sample_rate     =&gt; [44100,[44100,48000,88200]],</div>
<div class="line">      :path_to_tfx     =&gt; [<span class="stringliteral">&#39;none&#39;</span>],</div>
<div class="line">      :threshold       =&gt; [-96],</div>
<div class="line">    }</div>
<div class="line">end</div>
<div class="line"></div>
<div class="line">@dsh.init_dae(sample_rate)</div>
</div><!-- fragment --> <div class="fragmentcaption">Listing 2: Desribing input arguments for the script and using them</div></div><div class="section">Hash entries should be in the following format: </p><div class="TextInd1"> :arg_name =&gt; [default_value, [range of allowed values]] </div></div><div class="section">These arguments can be used then by just calling them by name, like in the example above with <code>sample_rate</code> argument.</div><div class="section"></div><h2><a class="anchor" id="writing_body_of_the_script"></a>
Writing body of the script</h2>
<div class="section"> The body of the script must be enclosed in the body of the <code>run</code> method of the script class. As far as most DTT tests need DSH, in the example below it's shows how to create a DSH instance in the script and how to use it then. DSH instance can be creted with <code>DigiDhell.new</code> method, which requites DigiShell module, as has already been said. Then all the DSH commands become available as methods of the DSH instance, and input arguments can be passed to these command as input arguments for the methods, i.e. in parentheses <code>dsh.load_dish("DAE")</code>. Also it's recommended to handle possible exceptions that may occure during the execution of the code, and to make sure that DSH has been closed, if it was instantiated on the moment of the failure.</div><div class="section"><div class="fragment"><div class="line">def run</div>
<div class="line">   begin</div>
<div class="line">      dsh = DigiShell.new(target)</div>
<div class="line">      dsh.load_dish(<span class="stringliteral">&quot;DAE&quot;</span>)</div>
<div class="line">      dsh.init_dae(sample_rate)</div>
<div class="line">      dsh.close</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">return</span> pass(<span class="stringliteral">&quot;Well, it didn&#39;t explode.  So that&#39;s something.&quot;</span>)</div>
<div class="line"></div>
<div class="line">   rescue Exception =&gt; e</div>
<div class="line">      <span class="preprocessor"># make sure to close down dsh before returning</span></div>
<div class="line">      <span class="keywordflow">if</span> (dsh)</div>
<div class="line">         dsh.close</div>
<div class="line">      end</div>
<div class="line">        </div>
<div class="line">      <span class="keywordflow">return</span> fail(e)</div>
<div class="line">   end</div>
<div class="line">end</div>
</div><!-- fragment --> <div class="fragmentcaption">Listing 3: Example of the body of the script.</div></div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="dtt_guide_04_logging_in_dtt_and_debuggin_dtt_scripts"></a>
Logging in DTT and debugging DTT scripts</h1>
<div class="section"> DTT tool has logging, and all the logs collected in the Logs folder, which is located in root directory of the DTT. DTT creates a separate folder for each test and names these folders with the corresponding names + the time when the particular test has been executed. For example:</div><div class="section"><code>DSH_SigCancellation_20131225_185146_0001</code></div><div class="section">Inside each folder there are several log files: </p><ul>
<li class="Bullet">
<em>xxx.html</em> – contains info about input &amp; output of the test in a fancy form (tables) </li>
<li class="Bullet">
<em>xxx_c.txt</em> – contains the list of the DSH commands that have been executed </li>
<li class="Bullet">
<em>xxx_d.txt</em> – DSH output </li>
<li class="Bullet">
<em>xxx_i.txt</em> – info about your system </li>
<li class="Bullet">
<em>xxx_l.txt</em> – standard output </li>
<li class="Bullet">
<em>xxx_v.txt</em> – verbose output </li>
</ul>
</div><div class="section"></div><h2><a class="anchor" id="dtt_guide_04_interactive_mode"></a>
Interactive mode</h2>
<div class="section"> There is an option to run DTT in interactive mode using interactive ruby shell (irb). When running in this mode, DTT creates a shell which is an extended version of the standard Ruby interpreter. Besides the standard functionality, it knows how to work with DTT classes and can give hints on their methods. In particular, the DTT interactive mode shell knows how to work with DigiShell.</div><div class="section">To run DTT in interactive mode, go to the DTT folder and launch the <code>run_irb</code> program. At this point you will send ruby commands to dsh through the pipe in YAML format:</div><div class="section"><div class="fragment"><div class="line">t = Target.new # creates an instance of Target. In <span class="keyword">this</span> <span class="keywordflow">case</span> target is a local machine, though we have a possibility to run test on remote machine.</div>
<div class="line">dsh = DigiShell.new(t) # creates an instance of DigiShell(aka launching dsh binary)</div>
<div class="line">dsh.load_dish(<span class="stringliteral">&#39;DAE&#39;</span>) #Loads <span class="stringliteral">&#39;DAE&#39;</span> dish</div>
<div class="line">dsh.help(<span class="stringliteral">&#39;init_dae&#39;</span>) # Requests help from dsh <span class="keywordflow">for</span> <span class="stringliteral">&#39;init_dae&#39;</span> command</div>
<div class="line">dsh.init_dae</div>
<div class="line">plugins = dsh.run #returns an array of plug-ins and writes them to plugins var.</div>
<div class="line">plug-ins[0] #reaching first plug-in from the list</div>
<div class="line"><span class="preprocessor">#... whatever you want to do</span></div>
</div><!-- fragment --> <div class="fragmentcaption">Listing 4: Running DTT in interactive mode</div></div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="dtt_guide_02_working_with_dtt_test_suites"></a>
Working with DTT test suites</h1>
<div class="section"> Suites are files which contain the list of DTT scripts that should be run, and parameteres for these tests. These files should be created in YAML format. The list of the tests should be preceeded by <code>tests:</code> line. Then tests to be run should be described as a map with the following members:</div><div class="section"><ul>
<li class="Bullet">
<code>name: </code> - name of the test </li>
<li class="Bullet">
<code>enabled: </code> - determines whether test will be run or skipped </li>
<li class="Bullet">
<code>args: </code> - input parameters of the test </li>
</ul>
</div><div class="section">The input parameters of the test should be orginized as a hash map. That means that all keys should start with ":" and look like ":plugin_spec: ".</div><div class="section">Also suite may contain a section with the general parameters like:</div><div class="section"><ul>
<li class="Bullet">
<code>verbose: false</code> which determines whether the output of the test in the console will be verbose or not. </li>
<li class="Bullet">
<code>timeoutFactor: "16.0"</code> which defines the time period, after which test will exit in case it stuck on the execution of the certain peice of code. </li>
</ul>
</div><div class="section">Example of the suite: </p><div class="fragment"><div class="line">suitesettings:</div>
<div class="line">  verbose: <span class="keyword">false</span> </div>
<div class="line">tests: </div>
<div class="line"><span class="preprocessor">#</span></div>
<div class="line"><span class="preprocessor"># Cycle counting test</span></div>
<div class="line"><span class="preprocessor">#</span></div>
<div class="line">- name: DSH_TI_CycleCounts </div>
<div class="line">  enabled: <span class="keyword">true</span> </div>
<div class="line">  args: </div>
<div class="line">    :plugin_spec: <span class="stringliteral">&#39;Digi,Pich,Psmm&#39;</span> </div>
<div class="line">    :sample_rate: 48000</div>
</div><!-- fragment --> <div class="fragmentcaption">Listing 5: Example of the DTT test suite</div></div><div class="section"><dl class="section note"><dt>Note</dt><dd>All the suites files should have an extension .gss</dd></dl>
</div><h2><a class="anchor" id="autogeneration_of_the_suites"></a>
Autogeneration of the suites</h2>
<div class="section"> Sometimes it is necessary to generate the suites for the particular script for all the plug-ins from the bundle and/or for different sample rates. In this case instead of the copy-paste, which may lead to some mistakes and erratums, suitegenerator can be used. This is a special script, which takes as arguments the name of the script(s), for which the suites should be generated, and the list of their input parameters. Strange as it may sound, this data should be formed as a suite. Script itself is available as SuiteGenerator.rb along with other scripts in the DTT.</div><div class="section"><dl class="section note"><dt>Note</dt><dd>SuiteGenerator.rb can generate suites only for the two tests: DSH_SigCancellation test and DSH_TI_CycleCounts test</dd></dl>
<p>Here is the example of how to use this script to generate the suites for all the plug-ins from the 'D-Verb' bundle for all the sample rates the cancellation test AAX Native vs AAX DSP, and for the cycle counts test:</div><div class="section"><div class="fragment"><div class="line">tests:</div>
<div class="line"><span class="preprocessor"># Generate suite for Cancellation test: AAX Native vs AAX DSP</span></div>
<div class="line">- name: SuiteGenerator</div>
<div class="line">  args: </div>
<div class="line">    :plugin_name: <span class="stringliteral">&#39;D-Verb&#39;</span></div>
<div class="line">    :path_to_audio_files: /Volumes/G_Audio/GS_Test_Resources/audio/</div>
<div class="line">    :path_to_presets: /Volumes/G_Audio/GS_Test_Resources/PL_Settings/</div>
<div class="line">    :test_script: DSH_SigCancellation</div>
<div class="line">  enabled: <span class="keyword">true</span></div>
<div class="line"><span class="preprocessor"># Generate suite for Instance Count test</span></div>
<div class="line">- name: SuiteGenerator</div>
<div class="line">  args: </div>
<div class="line">    :plugin_name: <span class="stringliteral">&#39;D-Verb&#39;</span></div>
<div class="line">    :path_to_presets: /Volumes/G_Audio/GS_Test_Resources/PL_Settings/</div>
<div class="line">    :test_script: DSH_TI_CycleCounts_se</div>
<div class="line">  enabled: <span class="keyword">true</span></div>
<div class="line">suitesettings: </div>
<div class="line">  verbose: <span class="keyword">false</span></div>
<div class="line">  timeoutFactor: <span class="stringliteral">&quot;16.0&quot;</span></div>
</div><!-- fragment --> <div class="fragmentcaption">Listing 6: Example of how to use SuiteGenerator script for generating suites for all the plug-ins from the 'D-Verb' bundle for the all sample rates for the cancellation and for the cycle counts test.</div></div><div class="section">To generate the suites, one should run this suite for the SuiteGenerator as an ordinary suite by executing the <code>run_test.command &lt;the name of the suite for the SuiteGenerator&gt;</code> command. All the suites will be generated into the single file, which will be located inside the suites folder, and will be called like:</div><div class="section"><code>dspVSnative(optional)_&lt;the name of the plug-in&gt;_&lt;the name of the test&gt;.gss</code></div><div class="section">Examples: </p><ul>
<li class="Bulet">
TRIM_DSH_TI_CycleCounts.gss </li>
<li class="Bulet">
dspVSnative_TRIM_DSH_SigCancellation.gss </li>
</ul>
</div><div class="section"></div> <div class="dynheader">
Collaboration diagram for DTT Guide:</div>
<div class="dyncontent">
<center><table><tr><td><img src="a00366.png" border="0" alt="" usemap="#a00366"/>
<map name="a00366" id="a00366">
<area shape="rect" id="node1" href="a00359.html" title="Documentation for specific AAX host environments. " alt="" coords="5,5,131,32"/></map>
</td></tr></table></center>
</div>
</div><!-- contents -->
<!--        Copyright 2016, 2018 by Avid Technology, Inc.        -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<div class="FooterLegal">This product may be protected by one or more U.S. and non-U.S. patents. Details are available at <a href="https://www.avid.com/patents">www.avid.com/patents</a>.</div>
Generated on Fri Feb 2 2018 21:15:15 for AAX SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>AAX SDK: DigiTrace Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="aaxdoxy.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="cw_105x65_aax_buf.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AAX SDK
   &#160;<span id="projectnumber">2.3.1</span>
   </div>
   <div id="projectbrief">Avid Audio Extensions Development Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Welcome</span></a></li>
      <li><a href="modules.html"><span>Manual</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="pages.html"><span>Lists</span></a></li>
      <li><a href="usergroup0.html"><span>Support</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">DigiTrace Guide<div class="ingroups"><a class="el" href="a00323.html">AAX SDK Manual</a> &raquo; <a class="el" href="a00359.html">AAX Host Guides</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<p>How to add tracing to your plug-ins and view logging from the plug-in host. </p>
<h1><a class="anchor" id="digitrace__contents"></a>
On this page</h1>
<ul>
<li><a class="el" href="a00364.html#digitrace__intro">What is DigiTrace?</a> </li>
<li><a class="el" href="a00364.html#digitrace__quickstart">DigiTrace quick start guide</a> </li>
<li><a class="el" href="a00364.html#digitrace__logfiles">DigiTrace log files</a> </li>
<li><a class="el" href="a00364.html#digitrace__configuring">Configuring DigiTrace</a> </li>
<li><a class="el" href="a00364.html#digitrace__bonus_features">Bonus features</a> </li>
<li><a class="el" href="a00364.html#digitrace__tracingfromplugins">Adding traces to an AAX plug-in</a> </li>
<li><a class="el" href="a00364.html#digitrace__advancedconfiguration">Advanced DigiTrace configuration</a> </li>
<li><a class="el" href="a00364.html#digitrace__compatibility">Compatibility</a> </li>
<li><a class="el" href="a00364.html#digitrace__additionalinformation">Additional Information</a></li>
</ul>
<div class="section"> </div><h1><a class="anchor" id="digitrace__intro"></a>
What is DigiTrace?</h1>
<div class="section"> DigiTrace is a logging tool used by many Avid audio applications. DigiTrace provides high-performance, real-time tracing capabilities and can help you debug hard-to-isolate problems in real-time code. Pro Tools and other Avid audio products are instrumented with DigiTrace, and it is easy to add DigiTrace logging to your AAX plug-ins.</div><div class="section"> This document outlines how to use DigiTrace, both as a developer to add trace instrumentation to your code and as an end user to view or record trace instrumentation for an instrumented application.</div><div class="section"></div><h2><a class="anchor" id="digitrace__intro__whatdoesitdo"></a>
What does DigiTrace do?</h2>
<div class="section"> DigiTrace generates encrypted logs on users' systems. These log files can be decrypted via the DigiTraceDecryptor application that is included in the DigiTrace Tools package.</div><div class="section"> By default, DigiTrace logs basic information including details about the system, software, component versions, and any errors that are encountered. By using a simple configuration text file, DigiTrace can be easily configured to provide additional logging information such as plug-in loading details. Here are some examples of how you can use DigiTrace:</div><div class="section"> <ul>
<li class="Bullet">
You can use DigiTrace in your plug-ins when you need a convenient, high-performance logging solution.  </li>
<li class="Bullet">
You can use the default DigiTrace logs that Pro Tools generates to help you understand problems that your plug-ins encounter when running on Pro Tools.  </li>
<li class="Bullet">
You can add DigiTrace statements and stack traces to your released plug-ins in order to help you troubleshoot end-user issues more quickly.  </li>
<li class="Bullet">
You can (and should!) submit DigiTrace logs when reporting bugs and other Pro Tools issues to Avid.  </li>
</ul>
</div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="digitrace__quickstart"></a>
DigiTrace quick start guide</h1>
<div class="section"> This section provides quick steps for the following common tasks: </p><ul>
<li><a class="el" href="a00364.html#digitrace__gettingstarted__logfiles">Find and decrypt DigiTrace log files</a> </li>
<li><a class="el" href="a00364.html#digitrace__gettingstarted__config">Configure DigiTrace for AAX plug-in logging</a> </li>
<li><a class="el" href="a00364.html#digitrace__gettingstarted__configurefordevelopment">Configure DigiTrace for plain-text output</a> </li>
<li><a class="el" href="a00364.html#digitrace__gettingstarted__addingtracing">Add tracing to a plug-in</a></li>
</ul>
</div><h2><a class="anchor" id="digitrace__gettingstarted__logfiles"></a>
Find and decrypt DigiTrace log files</h2>
<div class="section"> DigiTrace log files are placed into a common logs directory. The specific directory that is used depends on the version of DigiTrace - see <a class="el" href="a00364.html#digitrace__logfiles__wherearethelogs">Where are DigiTrace log files stored?</a></div><div class="section"> By default, the version of DigiTrace that is installed with Avid audio products generates logs in an encrypted format with the extension ".dlog". Developer builds of Pro Tools and other applications are configured to generate plain-text logs.</div><div class="section"> You can convert .dlog files to plain-text using the DigiTraceDecryptor tool that is included in the DigiTrace Tools package available for download from the Avid developer portal. To decrypt a log using this tool, simply drag-and-drop the .dlog file onto the tool. You can also set this tool as the default application for opening .dlog files in your OS, which will allow you to decrypt and open .dlog files directly.</div><div class="section"></div><h2><a class="anchor" id="digitrace__gettingstarted__config"></a>
Configure DigiTrace for AAX plug-in logging</h2>
<div class="section"> You must customize the DigiTrace configuration to enable extra logging, such as debug logging for <a class="el" href="a00288.html">AAX</a> plug-ins.</div><div class="section"> DigiTrace uses a plain-text configuration file to enable custom logging. This file uses the suffix ".digitrace" and is located within or beside the application. For example, the configuration files for Pro Tools are located at:</p><ul>
<li>OS X: Pro Tools.app/Contents/Resources/config.digitrace</li>
<li>Windows: C:\Program Files\Avid\Pro Tools\ProTools.digitrace</li>
</ul>
</div><div class="section"> To configure DigiTrace to print logs from <a class="el" href="a00158.html#ab53f1d6a94f8b6ebb3a101f71bfe4e82">AAX_TRACE</a> or <a class="el" href="a00158.html#ac2aa820ece56bb59140ad561218db4b3">AAX_TRACE_RELEASE</a> macros in <a class="el" href="a00288.html">AAX</a> plug-ins, add the following line to the .digitrace configuration file for the application:</div><div class="section"> <div class="TextInd1">DTF_AAXPLUGINS=file@DTP_LOWEST </div></div><div class="section"> If a config.digitrace file does not already exist for a DigiTrace-enabled application then you can create it to enable DigiTrace. For more information about customizing the DigiTrace configuration and enabling different levels of debug logging, see <a class="el" href="a00364.html#digitrace__configuring">Configuring DigiTrace</a> .</div><div class="section"></div><h2><a class="anchor" id="digitrace__gettingstarted__configurefordevelopment"></a>
Configure DigiTrace for plain-text output</h2>
<div class="section"> In order to be able to view streaming log output in real time, DigiTrace must be configured for plain-text output. This is the default configuration for developer builds of Pro Tools and other Avid audio applications.</div><div class="section"> To configure shipping applications for plain-text log output, you must replace the application's installed DigiTrace library with a development version of the DigiTrace library. Development builds of DigiTrace are included in the DigiTrace Tools package. Search for "Digitrace.framework" on OS X or "DigiTrace.dll" on Windows and replace the installed shipping version of the library with the developer version from the DigiTrace Tools package to configure the application for plain-text output.</div><div class="section"> Note that the developer version of DigiTrace may output logs to a different directory than the shipping version. In general, developer builds of DigiTrace will place log files in a directory next to the instrumented application. For example, developer builds of Pro Tools will output logs to a logs directory placed adjacent to the Pro Tools application bundle rather than in the user's Library/Logs/Avid folder.</div><div class="section"></div><h2><a class="anchor" id="digitrace__gettingstarted__addingtracing"></a>
Add tracing to a plug-in</h2>
<div class="section"> To easily add tracing to an <a class="el" href="a00288.html">AAX</a> plug-in, use the <a class="el" href="a00158.html#ab53f1d6a94f8b6ebb3a101f71bfe4e82">AAX_TRACE</a> or <a class="el" href="a00158.html#ac2aa820ece56bb59140ad561218db4b3">AAX_TRACE_RELEASE</a> macros. Logging from the "release" macro will be enabled for all builds of the plug-in, whereas logging from the "standard" macro will only be enabled in Debug builds of the plug-in.</div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="digitrace__logfiles"></a>
DigiTrace log files</h1>
<div class="section"> The default logging in Avid audio applications includes data that can be useful in many different troubleshooting situations. For example:</div><div class="section"><ul>
<li>Information about the user's system configuration</li>
<li>A complete list of loaded components and libraries. (If the user has an old or incompatible version of your plug-ins installed on his system, you will know about it!)</li>
<li>Crash logs in the event of a system failure</li>
</ul>
</div><div class="section"> In addition, you can add DigiTrace logging code to your plug-ins, helping you examine potential issues in the way your plug-in is running on a user's computer even when you cannot reproduce the issue locally.</div><div class="section"></div><h2><a class="anchor" id="digitrace__logfiles__wherearethelogs"></a>
Where are DigiTrace log files stored?</h2>
<div class="section"> </div><h3><a class="anchor" id="digitrace__logfiles__wherearethelogs__directory"></a>
Log directory</h3>
<div class="section"> DigiTrace logs are stored in a log files directory on the user's system. The default location of this directory depends on the operating system and on which version of DigiTrace is being used:</div><div class="section"> <ul>
<li class="Bullet">
Pro Tools / DigiTrace 11.0 and later: <div class="TextInd1">~/Library/Logs/Avid/ (OS X) </div> <div class="TextInd1">C:\Program Files\Avid\Pro Tools\Logs (Windows) </div>  </li>
<li class="Bullet">
Pro Tools / DigiTrace 9.0 - 10.3: <div class="TextInd1">~/Library/Logs/AvidLogFiles/ (OS X) </div> <div class="TextInd1">C:\Users\[username]\AvidLogFiles\ (Windows 7 or Windows 8) </div> <div class="TextInd1">C:\Documents and Settings\[username]\AvidLogFiles\ (Windows XP) </div>  </li>
<li class="Bullet">
Pro Tools / DigiTrace 8.0.3 - 8.5: <div class="TextInd1">[Pro Tools application directory]/LogFiles/ (All configurations) </div>  </li>
</ul>
</div><div class="section"> This default log directory can be overridden in the DigiTrace config file. See <a class="el" href="a00364.html#digitrace__advancedconfiguration">Advanced DigiTrace configuration</a> for more information.</div><div class="section"></div><h3><a class="anchor" id="digitrace__logfiles__wherearethelogs__name"></a>
Log file names</h3>
<div class="section"> By default the log file will be given a time-stamped name in the format <code>&lt;AppName&gt;_YYYY_MM_DD_HH_MM_SS.dlog</code>. This timestamp represents the system time when the log was created. Like the log directory, this log file name can be changed using the DigiTrace configuration. See <a class="el" href="a00364.html#digitrace__advancedconfiguration">Advanced DigiTrace configuration</a> for more information.</div><div class="section"></div><h2><a class="anchor" id="digitrace__logfiles__monitoring"></a>
Monitoring DigiTrace logs</h2>
<div class="section"></div><h3><a class="anchor" id="digitrace__logfiles__monitoring__files"></a>
Log files</h3>
<div class="section"> You can of course view a log file by opening it periodically. In addition, assuming that DigiTrace is <a class="el" href="a00364.html#digitrace__gettingstarted__configurefordevelopment">configured for plain text output</a>, you can also constantly monitor a log file in a "streaming" manner. This is possible using standard Unix tools included with OS X or with Cygwin on Windows. In fact, this approach usually works better than telling DigiTrace to use console output due to buffering of the console output.</div><div class="section"> <ul>
<li class="Bullet">
For basic real-time monitoring of a single file, use <code>tail</code>: <div class="TextInd1"><code>tail -f /path/to/digitrace/logs/the_logfile.txt </code></div>  </li>
<li class="Bullet">
For real-time monitoring of the most recent file in the log file directory, use a combination of <code>tail</code> and <code>ls</code>:  <DIV CLASS="TextInd1"><TT>tail -f `ls -d -1 -rt/path/to/digitrace/logs/&#42;.txt | tail -1` </TT></DIV>  </li>
</ul>
</div><div class="section"></div><h3><a class="anchor" id="digitrace__logfiles__monitoring__console"></a>
Console</h3>
<div class="section"> Console behavior is quite different between OS X and Windows</div><div class="section"> <em class="Bold">Windows </em> </p><div class="TextInd1">On Windows, traces sent to the console go to the system debugging console. The only way to view the console output is to be running with an attached debugger. </div></div><div class="section"> <em class="Bold">OS X </em> </p><div class="TextInd1">On the Mac, console traces are sent to stdout console, which shows up in a few places: </p><ul>
<li class="Bullet">
If you're running in a debugger, the debug console will display stdout output, including DigiTrace messages  </li>
<li class="Bullet">
If you're not in the debugger, you can view the output in the Console app (/Applications/Utilities/Console). For Pro Tools, look under ~/Library/Logs/Avid/Pro Tools.X.log in the log list. Note that these messages are not displayed in the "All Messages" log.  </li>
<li class="Bullet">
Alternately, you can manually look at the log output, again using the <code>tail</code> command, e.g. <code>tail -f "~/Library/Logs/Avid/Pro Tools.0.log"</code>  </li>
</ul>
</div></div><div class="section"></div><h2><a class="anchor" id="digitrace__logfiles__format"></a>
Log file formatting</h2>
<div class="section"> Here is the beginning of an example DigiTrace log: </p><pre class="fragment">*** Digidesign Session Trace for:	/Applications/Pro Tools 11.0.2 3PDev.app (pid=0x5aff, version=11.0.2d626)
*** Starting Timestamp:			Tuesday, January 7, 2014 4:10:57 PM Eastern Standard Time (89706938666 uS)
*** System Details:			OS Version: 10.8,5, CPU Speed:  2.7 gHz, Architecture: Intel 64 bit, Num Processors: 8 logical 4 physical, Memory: 16384 MB
*** DigiTrace Config File:		/Applications/Pro Tools 11.0.2 3PDev.app/Contents/Resources/config.digitrace
*** Facilities to trace:

DTF_INSTALLED_COMPONENTS@DTP_NORMAL(0e0d)

Time(us),Tid,Facility,Name : Debug Message
---------------------------------------------------------------------------
89707181683,00c07,0e0d: Pace eden lib version: 2.0.0, r22343 (2.0.0.22343),  [...]
89707220338,00c07,0e0d: ShoeTool_Init - shoe tool installed version is 6.000 [...]
89707220374,00c07,0e0d: ShoeTool_IncreaseAIOLimits - var=46, newVal=512, cur [...]
89707220380,00c07,0e0d: ShoeTool_IncreaseAIOLimits - var=47, newVal=512, cur [...]	 </pre></div><div class="section"> The log file consists of a header followed by a series of log statements. Each log statement includes the following information:</div><div class="section"> <ul>
<li class="Bullet">
Time(us) - The time the message was logged, in microseconds since the machine was started.  </li>
<li class="Bullet">
Tid - The thread ID of the thread that logged the message.  </li>
<li class="Bullet">
Facility - The Facility ID of the facility that's logging the message.  </li>
<li class="Bullet">
Name - This is the config name added to all facilites included by this config file. This can be used to group all facilites related to a feature set, for instance. If not set, this is not included.  </li>
<li class="Bullet">
Debug Message - This is the actual string passed to the trace facility.  </li>
</ul>
</div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="digitrace__configuring"></a>
Configuring DigiTrace</h1>
<div class="section"> You can configure DigiTrace to include or exclude specific traces using the config.digitrace configuration file. This file is plain text and includes a single configuration command on each line.</div><div class="section"> This is the basic format for a command used to enable tracing for a single <a class="el" href="a00364.html#digitrace__configuring__facility">facility</a>:</div><div class="section"> <div class="TextInd1"><em class="Italic">facility</em>=[console@<em class="Italic">minimum console logging priority</em>],[file@<em class="Italic">minimum file logging priority</em>] </div></div><div class="section"> Here are some examples:</div><div class="section"> <ul class="paragraphs">
<li>
<code>DTF_APP_VERSION=file@DTP_LOW </code> </li>
<li>
<code>DTF_PLUGINS_3P=file@DTP_LOW,console@DTP_URGENT </code> </li>
<li>
<code>DTF_ASSERTHANDLER=console@DTP_URGENT </code> </li>
<li>
<code>DTF_DAE_MEM=console@DTP_URGENT,file@DTP_LOWEST </code> </li>
</ul>
</div><div class="section"> For more information about special configuration commands, see <a class="el" href="a00364.html#digitrace__advancedconfiguration">Advanced DigiTrace configuration</a>.</div><div class="section"></div><h2><a class="anchor" id="digitrace__configuring__facility"></a>
Trace facilities</h2>
<div class="section"> Trace facilities are used by DigiTrace to determine whether or not the given trace statement should be displayed. Trace facilities allow the user to filter trace statements at the component level.</div><div class="section"></div><h2><a class="anchor" id="digitrace__configuring__priority"></a>
Trace priorities</h2>
<div class="section"> Trace priorities are used by DigiTrace to determine whether or not the given trace statement should be displayed. DigiTrace specifies five trace priorities:</div><div class="section"> <ul class="paragraphs">
<li>
<code>DTP_LOWEST </code> </li>
<li>
<code>DTP_LOW </code> </li>
<li>
<code>DTP_NORMAL </code> </li>
<li>
<code>DTP_HIGH </code> </li>
<li>
<code>DTP_URGENT </code> </li>
</ul>
</div><div class="section"> The DigiTrace configuration file specifies minimum trace priorities. For example, if a trace statement uses <code>DTP_LOW</code> and DigiTrace is configured to use <code>DTP_NORMAL</code> as the minimum trace priority, then the trace statement will not be sent to the output target. In general, the <code>DTP_LOWEST</code> priority setting will populate the trace output with the most verbose information while the <code>DTP_URGENT</code> setting will output only the most high level details.</div><div class="section"></div><h2><a class="anchor" id="digitrace__configuring__facilities"></a>
Useful DigiTrace facilities</h2>
<div class="section"> This section includes descriptions of several facilities that are used in Pro Tools and other Avid audio products. The logging provided by these facilities may be helpful when diagnosing plug-in issues.</div><div class="section"> <ul>
<li class="Bullet">
<p class="startli"><code>DTF_AAXPLUGINS</code> </p><div class="TextInd1">This is the standard facility for <a class="el" href="a00288.html">AAX</a> plug-ins. This facility will only log traces that are present in <a class="el" href="a00288.html">AAX</a> plug-ins themselves, not traces in any hosting code. Plug-ins may use the <a class="el" href="a00158.html#ab53f1d6a94f8b6ebb3a101f71bfe4e82">AAX_TRACE</a> or <a class="el" href="a00158.html#ac2aa820ece56bb59140ad561218db4b3">AAX_TRACE_RELEASE</a> macros to log to this facility. </div><dl class="section note"><dt>Note</dt><dd>Disabling the <code>DTF_AAXPLUGINS</code> facility will slightly reduce the overhead of trace statements and chip communication on HDX systems.  </dd></dl>
</li>
<li class="Bullet">
<code>DTF_AAXHOST</code> at <code>DTP_NORMAL</code> <div class="TextInd1">Logging from the main <a class="el" href="a00288.html">AAX</a> host component. Use a lower priority for additional <a class="el" href="a00288.html">AAX</a> Host tracing.</div>  </li>
<li class="Bullet">
<code>DTF_PLUGINS</code> at <code>DTP_LOW</code> <div class="TextInd1">Miscellaneous plug-in operations, including page table logging, preset directory errors, and DLL loading and unloading</div>  </li>
<li class="Bullet">
<code>DTF_TIPLUGINS</code> at <code>DTP_NORMAL</code> <div class="TextInd1">Logging for HDX plug-in algorithm handling details such as packet management and private data field state reset. Use <code>DTP_LOW</code> for deeper tracing.</div>  </li>
<li class="Bullet">
<code>DTF_TISHELLMGR</code> at <code>DTP_HIGH</code> <div class="TextInd1">Logging from the HDX RTOS</div>  </li>
<li class="Bullet">
<code>DTF_DAE_HOSTDEVICE</code> at <code>DTP_URGENT</code> <div class="TextInd1">Performance logging from the real-time audio render thread. See <a class="el" href="a00364.html#digitrace__performancelogging">Real-time AAE performance logging with DigiTrace</a></div>  </li>
<li class="Bullet">
<code>DTF_DAE_ERRORS</code> at <code>DTP_NORMAL</code> or <code>DTP_LOW</code> <div class="TextInd1">Information about any errors that occur in AAE. Use <code>DTP_LOW</code> to enable stack traces. </div>  </li>
<li class="Bullet">
<code>DTF_ASSERTHANDLER</code> at <code>DTP_NORMAL</code> or <code>DTP_LOW</code> <div class="TextInd1">Similar to <code>DTF_DAE_ERRORS</code>: Information about any asserts that fail. Use <code>DTP_LOW</code> to enable stack traces. </div>  </li>
<li class="Bullet">
<code>DTF_THREAD_NAMES_AND_PRIORITIES</code> at <code>DTP_NORMAL</code> or <code>DTP_LOW</code> <div class="TextInd1">Allows you to look up a thread's debug name from its ID on the standard trace line. Thread names and IDs will be traced as they are created, and you can then use that ID to resolve the thread name of later trace statements. Use <code>DTP_NORMAL</code> for just names and IDs, and <code>DTP_LOW</code> to include priorities. </div>  </li>
<li class="Bullet">
<code>DTF_PACESUPPORT</code> at <code>DTP_NORMAL</code> <div class="TextInd1">Plug-in digital signature logging, with some diagnostics for digital signature verification failures.</div>  </li>
<li class="Bullet">
<code>DTF_ADC</code> at <code>DTP_NORMAL</code> <div class="TextInd1">Delay compensation logging, including host accounting for plug-in latency.</div>  </li>
<li class="Bullet">
<code>DTF_AUTOMATION</code> at <code>DTP_LOW</code> <div class="TextInd1">Parameter touch and release logging.</div>  </li>
<li class="Bullet">
<code>DTF_AUDIOSUITE</code> at <code></code> <div class="TextInd1">Logging of events specific to AudioSuite plug-in instances.</div>  </li>
</ul>
</div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="digitrace__bonus_features"></a>
Bonus features</h1>
<div class="section"> </div><h2><a class="anchor" id="digitrace__performancelogging"></a>
Real-time AAE performance logging with DigiTrace</h2>
<div class="section"> Pro Tools 11 and higher includes logging for audio render callback performance. To enable this logging, enabled the <code>DTF_DAE_HOSTDEVICE</code> facility at <code>DTP_URGENT</code>. This facility will enable logging of real-time audio render thread metrics around any render errors that occur.</div><div class="section"> Here is an example of a performance log:</div><div class="section"> <div class="TextInd1"><code>Int(LL): hstEr=0, ioEr=0, dif=2665(2891,23129), tot=<em class="Bold">2517</em>(<em class="Bold">1648</em>,2317), in=51(58,83), clbk=2158(1508,2158), out=108(99,164), offset=[12], mxW=1101(<em class="Bold">com.avid.aax.eleven.free</em>) </code></div></div><div class="section"> The different values included in this log are:</div><div class="section"> <ul>
<li class="Bullet">
<code>hstEr </code> <div class="TextInd1"> </div>  </li>
<li class="Bullet">
<code>ioEr </code> <div class="TextInd1"> </div>  </li>
<li class="Bullet">
<code>dif </code> <div class="TextInd1"> </div>  </li>
<li class="Bullet">
<code>tot </code> <div class="TextInd1"> </div>  </li>
<li class="Bullet">
<code>in </code> <div class="TextInd1"> </div>  </li>
<li class="Bullet">
<code>clbk </code> <div class="TextInd1"> </div>  </li>
<li class="Bullet">
<code>out </code> <div class="TextInd1"> </div>  </li>
<li class="Bullet">
<code>offset </code> <div class="TextInd1"> </div>  </li>
</ul>
</div><div class="section"> A log of 'x=a (b,c)' means that the (x) value (e.g. <code>tot</code>) for the interrupt was (a) us, the running average was (b) us, and the maximum value encountered was (c) us. Therefore, in the example above:</div><div class="section"> <ul>
<li class="Bullet">
1648 us average total time was spent in each interrupt  </li>
<li class="Bullet">
2517 us was spent in this interrupt  </li>
<li class="Bullet">
Eleven Free was the longest worker in this interrupt  </li>
</ul>
</div><div class="section"> In practice, it is difficult to precisely log this information during an error. This is due to changes in the interrupt pattern and scheduling when the audio engine is halted. In order to account for this, the performance logging will print out logs for several interrupts around when any error occurs. The actual audio engine error (<code>hstEr</code>) may be reported for a "junk" interrupt cycle that is spuriously logged during this halt process.</div><div class="section"></div><h2><a class="anchor" id="digitrace__signposting"></a>
Adding signposts to the DigiTrace log at run-time</h2>
<div class="section"> Use the shift-'~' key combination to add a "Trace Flag" line into the DigiTrace log. This allows you to add a "signpost" line to the log right when an important event happens, or before/after an important operation, so that it is easier to find the important details when inspecting the log later.</div><div class="section"><pre class="fragment">176603608088,2b603,0016: DSK_PrePrimeDiskTask::PrePrimeDiskTask - finish
176603961348,00307,0000: Trace Flag 3 (diff prev: 2.40s, diff start: 7.18s)
176605252296,00307,0000: Trace Flag 4 (diff prev: 1.29s, diff start: 8.47s)
176605252779,00307,0f09: 2016-07-19 23:36:32.499 PTC_Mgr::Idle() -- performing task (Websocket Base)
176606039830,00307,0000: Trace Flag 5 (diff prev: 0.79s, diff start: 9.26s)</pre></div><div class="section"> Each trace flag signpost includes the text "Trace Flag" and the diff (in seconds) from both the previous trace flag and the first trace flag which was triggered during the current run of the app.</div><div class="section"> These lines will be printed regardless of the current DigiTrace configuration settings.</div><div class="section"><dl class="compatibility_notes"><dt><b><a class="el" href="a00380.html#_compatibility_notes000005">Host Compatibility Notes:</a></b></dt><dd>This feature is available in Pro Tools 12.6 and higher</dd></dl>
</div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="digitrace__tracingfromplugins"></a>
Adding traces to an AAX plug-in</h1>
<div class="section"> </div><h2><a class="anchor" id="digitrace__tracingfromplugins__basiclogging"></a>
Basic AAX logging</h2>
<div class="section"> Standard <code>printf</code>-style logging from <a class="el" href="a00288.html">AAX</a> plug-ins is very easy. This feature is built into the <a class="el" href="a00288.html">AAX</a> specification and is exposed to plug-ins via the <a class="el" href="a00158.html#ab53f1d6a94f8b6ebb3a101f71bfe4e82">AAX_TRACE</a> and <a class="el" href="a00158.html#ac2aa820ece56bb59140ad561218db4b3">AAX_TRACE_RELEASE</a> macros. For more information about basic logging, see the documentation for those macros.</div><div class="section"> <dl class="section note"><dt>Note</dt><dd>To enable basic <a class="el" href="a00288.html">AAX</a> logging via these macros, the <code>DTF_AAXPLUGINS</code> trace facility must be enabled.</dd></dl>
</div><h3><a class="anchor" id="digitrace__tracingfromplugins__basiclogging__dsp"></a>
Tracing for AAX DSP</h3>
<div class="section"> The <a class="el" href="a00158.html#ab53f1d6a94f8b6ebb3a101f71bfe4e82">AAX_TRACE</a> and <a class="el" href="a00158.html#ac2aa820ece56bb59140ad561218db4b3">AAX_TRACE_RELEASE</a> macros, as well as <a class="el" href="a00158.html#a168ee44fd7a5485ab50160db36fb2988">AAX_ASSERT</a>, are cross-platform and are supported for use in <a class="el" href="a00288.html">AAX</a> DSP algorithms. For more information about tracing from <a class="el" href="a00288.html">AAX</a> DSP algorithms, see the <a class="el" href="a00362.html#subsection__tracing">Tracing</a> section in the <a class="el" href="a00362.html">TI Guide</a>.</div><div class="section"></div><h2><a class="anchor" id="digitrace__tracingfromplugins__advancedlogging"></a>
Advanced DigiTrace logging features</h2>
<div class="section"> As a developer, you can use several advanced macros to extend the functionality of DigiTrace logging in your plug-in beyond the simple <code>printf</code>-style features provided by <a class="el" href="a00158.html#ab53f1d6a94f8b6ebb3a101f71bfe4e82">AAX_TRACE</a>. The full DigiTrace macro suite includes macros for stack traces, very long traces, or even the ability to dump a block of memory to the log.</div><div class="section"> Note that these advanced features are only available on the host system. They are not currently available from algorithms running on embedded hardware.</div><div class="section"></div><h3><a class="anchor" id="digitrace__advancedlogging__filestoinclude"></a>
What files do I include in my project?</h3>
<div class="section"> To add advanced DigiTrace instrumentation to your source code you must:</div><div class="section"><ol type="1">
<li>Include DigiTrace.h in the file where you are going to put your trace statements.</li>
<li>Compile CDigitraceAccess.cpp into your project</li>
</ol>
</div><div class="section"> If you have problems including the DigiTrace header file, try moving it to the top of the file that you're including it into. DigiTrace has no other dependencies and should be safe to include into any component.</div><div class="section"></div><h3><a class="anchor" id="digitrace__advancedlogging__filestoinclude__troubleshooting"></a>
What do I do if I encounter problems compiling or linking?</h3>
<div class="section"> Should you run into linker errors or other problems after adding the DigiTrace header file, please go through the following items and verify that each is included in your project:</div><div class="section"><ul>
<li>The CDigitraceAccess.cpp file automatically searches for and loads the DigiTrace.dll (Windows) or DigiTrace.framework (Mac) component and ensures that the appropriate function pointers are initialized. If you receive linker errors, the missing symbols are likely in this file. Note that your project will need the path to CDigiTraceAccess.h in order to compile this file.</li>
<li>If you receive an include file error for DigiPragmas.h then you will need to add the header's path to your project's search paths. This file is included in the most recent DigiTrace Tools packages but may not be included in some older packages.</li>
</ul>
</div><div class="section"></div><h3><a class="anchor" id="digitrace__advancedlogging__macros"></a>
Macros</h3>
<div class="section"> DigiTrace provides five core macros for trace output, which are:</div><div class="section"><ul>
<li><code>TRACE_R </code> - for general printf style tracing. Subject to a total line limit of 256 chars.</li>
<li><code>TRACE_PUTS_R </code> - prints an arbitrary length buffer, splitting it up into clean lines based on line breaks. No formatting.</li>
<li><code>STACKTRACE_R </code> - for stack trace printing. See below.</li>
<li><code>MEMTRACE_R </code> - for memory buffer hex tracing</li>
<li><code>FXTRACE_R </code> - for automatic function entry and exit tracing</li>
</ul>
</div><div class="section"></div><h3><a class="anchor" id="digitrace__advancedlogging__macros__debugvsrelease"></a>
Debug vs. release macros</h3>
<div class="section"> All of the macros listed above are general-use macros, which generate output in both Debug and Release builds. They each have a debug-only variant which excludes the trailing "&lt;TT&gt;_R&lt;/TT&gt;". Like <a class="el" href="a00158.html#ab53f1d6a94f8b6ebb3a101f71bfe4e82">AAX_TRACE</a>, these debug-only versions compile to a noop in release builds.</div><div class="section"> The use of debug-only macros is not usually necessary due to the fact that release traces are encrypted and hidden from end users (but not from other developers.) As a best practice, we recommend using the "_R" version of a macro whenever possible. The debug versions of the macros should only be necessary in special circumstances where you specifically do not want to compile the code into release builds.</div><div class="section"> For more information about tracing in release builds see <a class="el" href="a00364.html#digitrace__tracingfromplugins__security">Security concerns</a></div><div class="section"></div><h3><a class="anchor" id="digitrace__advancedlogging__macros__syntax"></a>
Syntax</h3>
<div class="section"> Adding a DigiTrace statement to your code is as easy as making a single function call thanks to DigiTrace's predefined macros. The basic macro syntax is:</div><div class="section"><div class="fragment"><div class="line">MACRO_NAME( TRACE_FACILITY_NAME [| TRACE_PRIORITY_LEVEL], MESSAGE_STRING )</div>
</div><!-- fragment --></div><div class="section"> Here is a code sample:</div><div class="section"><div class="fragment"><div class="line"><span class="keywordtype">bool</span> my_function(<span class="keywordtype">char</span>*  data_buffer, <span class="keywordtype">int</span> data_buffer_len)</div>
<div class="line">{</div>
<div class="line">     FXTRACE_R( DTF_PLUGINS_3P, <span class="stringliteral">&quot;my_function&quot;</span> ); <span class="comment">// Automatically trace function entry and exit.</span></div>
<div class="line">     <span class="comment">// You need only to specify a trace facility.</span></div>
<div class="line"></div>
<div class="line">     OSErr err = FrobnicateBuffer(data_buffer, data_buffer_len);</div>
<div class="line">     <span class="keywordflow">if</span>( noErr != err )</div>
<div class="line">     {</div>
<div class="line">          TRACE_R( DTF_PLUGINS_3P | DTP_HIGH, <span class="stringliteral">&quot;Couldn&#39;t frobnicate the buffer: %s&quot;</span>, OSErrToString(err) );</div>
<div class="line">     }</div>
<div class="line">     <span class="keywordflow">else</span></div>
<div class="line">     {</div>
<div class="line">          <span class="keywordtype">int</span> cBytesToTrace = 64;</div>
<div class="line">          MEMTRACE( DTF_PLUGINS_3P | DTP_LOW, <span class="stringliteral">&quot;Data after frobnication&quot;</span>, data_buffer, cBytesToTrace );</div>
<div class="line">     }</div>
<div class="line">}</div>
</div><!-- fragment --></div><div class="section"></div><h3><a class="anchor" id="digitrace__advancedlogging__stacktrace"></a>
Generating stack traces</h3>
<div class="section"> The <code>STACKTRACE_R</code> macro is very useful for getting stack traces of important events in the code like throwing errors (which can be thrown from many locations). One particularly useful feature of this macro is that it allows you to specify a facility and priority for the printf part of the stacktrace, e.g. <code>DTP_NORMAL</code>, and another one for the stacktrace step, e.g. <code>DTP_LOW</code>. See DigiTrace.h for a full list of macros and their documentation.</div><div class="section"></div><h3><a class="anchor" id="digitrace__advancedlogging__disabletracing"></a>
Turning off tracing in a specific file</h3>
<div class="section"> You can explicitly disable tracing in an instrumented file in the build by defining the <code>MTurnDbgTraceOff</code> symbol at the top of the file.</div><div class="section"></div><h2><a class="anchor" id="digitrace__tracingfromplugins__security"></a>
Security concerns</h2>
<div class="section"> Unless you provide your own logging encryption, DigiTrace logs are not secure and should not be used to store any sensitive information.</div><div class="section"> Logs generated by Pro Tools release builds on users' systems are encrypted. This is primarily for the sake of avoiding confusion in our user community, since DigiTrace logs can be cryptic and potentially misleading for users who are not familiar with our code.</div><div class="section"> Avid and other third-party developers will see your plug-ins' release trace statements if they load your plug-ins with the appropriate trace facilities enabled. We highly recommend that you keep this in mind when developing your trace statements, both in order to prevent confusion (see the formatting guidelines in the <a class="el" href="a00158.html#ac2aa820ece56bb59140ad561218db4b3">AAX_TRACE_RELEASE</a> documentation) and in order to maintain the security of your code.</div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="digitrace__advancedconfiguration"></a>
Advanced DigiTrace configuration</h1>
<div class="section"> The basic configuration command to enable tracing for a facility is described above in <a class="el" href="a00364.html#digitrace__configuring">Configuring DigiTrace</a>.</div><div class="section"> There are also additional commands that can be added to the DigiTrace configuration file for more advanced configurations.</div><div class="section"></div><h2><a class="anchor" id="digitrace__advancedconfiguration__commandformat"></a>
Configuration command format</h2>
<div class="section"> <ul>
<li class="Bullet">
All DigiTrace configuration commands are listed in the configuration file with the form &lt;token&gt;=&lt;value&gt;  </li>
<li class="Bullet">
Any blank line or line beginning with a '<code>#</code>' character is ignored  </li>
<li class="Bullet">
Tokens are not case sensitive  </li>
<li class="Bullet">
If there are repeated tokens in a file, the last token wins  </li>
</ul>
</div><div class="section"></div><h2><a class="anchor" id="digitrace__advancedconfiguration__commands"></a>
Advanced configuration commands</h2>
<div class="section"> <ul class="paragraphs">
<li>
<code>FileTracingDir = { DIRPATH } </code> <ul>
<li>
Default: <code>USE_RELATIVE_PATH</code>  </li>
<li>
Custom log file directory. e.g. "C:\MyTraceDir" on Windows or "~/MyTraceDir" on OS X.  </li>
<li>
If DIRPATH == USE_RELATIVE_PATH then the output trace file directory will be created next to the target application.  </li>
</ul>
</li>
<li>
<code>Append = { true | false } </code> <ul>
<li>
Default: <code>false</code>  </li>
<li>
Append to file. If <code>true</code>, the output of this trace will be appended to any existing log file with the same name. Otherwise, this trace will overwrite an existing log file with the same name.  </li>
</ul>
</li>
<li>
<code>LogFileLimit = { LIMIT } </code> <ul>
<li>
Default: no limit  </li>
<li>
Limits the number of log files kept around for this config file to the specified number.  </li>
<li>
If set to an integer value, DigiTrace will delete the oldest log file(s) until there are only N most recent log files in the output folder.  </li>
<li>
If you rename an output file so it does not have the standard prefix, it is never deleted by this option.  </li>
<li>
Does not work with the "append" option  </li>
</ul>
</li>
<li>
<code>TraceQueueSize = { small | medium | large } </code> <ul>
<li>
Default: <code>small</code>  </li>
<li>
This controls the amount of memory allocated to the trace queue. You probably won't need to change it.  </li>
</ul>
</li>
<li>
<code>BeQuiet = { true | false } </code> <ul>
<li>
Default: <code>false</code>  </li>
<li>
"Quiet" mode. If set to <code>true</code>, this configuration option makes all trace output occur without any decoration (i.e. no timestamps, no thread id, no process id, etc.).  </li>
<li>
This mode may be useful for some types of real-time vector tracing or for configuring formatted logs for post-processing with a text editor.  </li>
</ul>
</li>
<li>
<code>FileId = { FILEID } </code> <ul>
<li>
Default: none  </li>
<li>
If set, this string is included in the filename created by DigiTrace for trace output files.  </li>
<li>
Does not work with the "append" option  </li>
</ul>
</li>
<li>
<code>Name = { NAME } </code> <ul>
<li>
Default: none  </li>
<li>
If set, this string is included in every trace for all the facilities that are enabled in this config file.  </li>
<li>
You can have one of these per config file.  </li>
</ul>
</li>
</ul>
</div><div class="section"></div><h2><a class="anchor" id="digitrace__advancedconfiguration__dynamicreconfiguation"></a>
Dynamically changing the DigiTrace configuration</h2>
<div class="section"> DigiTrace config files can be loaded dynamically, which means that you can add new configs while the instrumented application is running. Below are the details surrounding dynamic loading:</div><div class="section"> <ul>
<li class="Bullet">
In debug builds, this will happen each time the app comes to the foreground.  </li>
<li class="Bullet">
The API only does anything if something has changed in your config files that will result in different tracing of some sort. If nothing has changed, the overhead to make the call is &lt; 1ms, and current tracing is not affected.  </li>
<li class="Bullet">
If something has changed, the changes are merged in to the existing config objects in memory. Active log files are not interrupted when possible. This takes around 200ms (mostly because of a sleep command that lets threads finish tracing things). Traces that happen in threads during this changeover will be dropped.  </li>
<li class="Bullet">
No code in the actual tracing commands was changed.  </li>
<li class="Bullet">
You can change any of the attributes of the trace facilities (priority level, file or console, etc).  </li>
<li class="Bullet">
You can add new config files on the fly, or if you start with no config file, you can add one on the fly.  </li>
</ul>
</div><div class="section"></div><div class="section"> </div><h1><a class="anchor" id="digitrace__compatibility"></a>
Compatibility</h1>
<div class="section"> DigiTrace is an internal testing and troubleshooting tool. Although we will try to provide up-to-date documentation so that third-party developers can use this tool, we may need to change the way that DigiTrace works at some point and so we cannot make any promises regarding forwards-compatibility.</div><div class="section"> At the time of this writing:</p><ul>
<li>DigiTrace is fully compatible with Pro Tools 8.0.3 and later. DigiTrace is installed by default with compatible Pro Tools shipping versions and with some Pro Tools Development Builds.</li>
<li>DigiTrace is compatible with all versions of the DAE dish in the DSH environment. Tracing must be explicitly enabled in the dsh executable by placing a config.digitrace config file next to the executable.</li>
</ul>
</div><div class="section"> If you notice significant bugs or other problems with DigiTrace in any Pro Tools release then we encourage you to report the issues to us on the developer forum. We may not be able to address issues immediately, but your feedback is appreciated.</div><div class="section"></div><h1><a class="anchor" id="digitrace__additionalinformation"></a>
Additional Information</h1>
<div class="section"></div><h2><a class="anchor" id="digitrace__additionalinformation__confidentiality"></a>
Confidentiality</h2>
<div class="section"> As with all information provided in the <a class="el" href="a00288.html">AAX</a> SDK, the information provided in this documentation is confidential and is bound by the terms of your NDA with Avid. You may provide customized DigiTrace configuration files to end users in order to generate useful debugging information on their systems. However, you may not provide users with decrypted DigiTrace logs or with other details provided in this DigiTrace documentation.</div><div class="section"></div> <div class="dynheader">
Collaboration diagram for DigiTrace Guide:</div>
<div class="dyncontent">
<center><table><tr><td><img src="a00364.png" border="0" alt="" usemap="#a00364"/>
<map name="a00364" id="a00364">
<area shape="rect" id="node1" href="a00359.html" title="Documentation for specific AAX host environments. " alt="" coords="5,5,131,32"/></map>
</td></tr></table></center>
</div>
</div><!-- contents -->
<!--        Copyright 2016, 2018 by Avid Technology, Inc.        -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
<div class="FooterLegal">This product may be protected by one or more U.S. and non-U.S. patents. Details are available at <a href="https://www.avid.com/patents">www.avid.com/patents</a>.</div>
Generated on Fri Feb 2 2018 21:15:15 for AAX SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
